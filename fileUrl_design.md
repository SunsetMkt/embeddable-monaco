# fileUrl 参数功能设计

## 功能概述
为 embeddable-monaco 添加 fileUrl 参数支持，使编辑器能够从指定的 URL 加载文件内容并显示。

## 设计要点

### 1. 参数解析
- 在现有的 URL 参数解析逻辑中添加对 fileUrl 参数的支持
- fileUrl 参数应接受一个有效的 URL 字符串，指向要加载的文件

### 2. 优先级处理
- 当同时存在 fileUrl 和 code 参数时，fileUrl 应具有更高优先级
- 实现逻辑：先检查 fileUrl 参数，如果存在则从 URL 加载内容；如果不存在或加载失败，则回退到 code 参数的内容

### 3. 内容加载机制
- 使用 fetch API 异步加载 fileUrl 指定的文件内容
- 加载应在编辑器初始化之前完成，以确保内容在编辑器创建时可用
- 对于大文件，考虑添加加载指示器或状态提示

### 4. 错误处理
- 处理网络错误：当 fetch 请求失败时提供适当的错误信息
- 处理跨域限制：提供关于可能的跨域问题的清晰错误信息
- 处理内容格式问题：确保加载的内容可以正确显示在编辑器中

### 5. 语言检测（可选增强）
- 基于文件扩展名或内容自动检测语言
- 如果未指定 lang 参数，则尝试从 fileUrl 推断语言

## 实现流程

1. 在编辑器初始化前检查 fileUrl 参数
2. 如果存在 fileUrl，使用 fetch 异步加载内容
3. 加载成功后，将内容设置为编辑器的初始值
4. 如果加载失败，回退到 code 参数的内容，并在控制台输出错误信息
5. 继续正常的编辑器初始化流程

## 代码修改位置

主要修改将在 `embed.ts` 文件中进行，具体修改点：

1. 在编辑器选项设置之前添加 fileUrl 内容加载逻辑
2. 修改 options 对象的 value 属性设置逻辑，考虑 fileUrl 加载的内容
3. 添加适当的错误处理和日志记录

## 兼容性考虑

- 确保修改不影响现有功能和参数
- 保持与嵌入页面的消息通信机制兼容
- 考虑各种浏览器的兼容性问题，特别是在跨域请求方面
